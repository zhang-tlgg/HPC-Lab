# 小作业七：单机性能优化

张天乐 2018011038

### 任务零

| 编译器参数        | -O0           | -O1           | -O2           | -O3           | -fast         |
| ------------ | ------------- | ------------- | ------------- | ------------- | ------------- |
| Elapsed time | 0.9667 s      | 0.3429 s      | 0.3361 s      | 0.0492 s      | 0.0395 s      |
| performance  | 0.2777 GFlops | 0.7829 GFlops | 0.7988 GFlops | 5.4540 GFlops | 6.7950 GFlops |

### 任务一

| 循环展开程度       | 1              | 2              | 4              | 8              | 16             |
| ------------ | -------------- | -------------- | -------------- | -------------- | -------------- |
| Elapsed time | 2.1190 s       | 1.9542 s       | 1.8100 s       | 1.7822 s       | 1.8346 s       |
| performance  | 15.4643 GFlops | 16.7676 GFlops | 18.1037 GFlops | 18.3867 GFlops | 17.8608 GFlops |

### 问题

##### 1. 参数 (`-O0`, `-O1`, `-O2`, `-O3`, `-fast`) 分别进行了哪些编译优化。

O1：启用速度优化，禁用了某些增加代码大小和影响速度的优化。

优化技术：

- 实现全局优化；这包括数据流分析、代码移动、强度降低和测试替换、生命周期分离分析和指令调度。

- 禁用某些内部函数的内联。

O2：在 O2 和更高级别启用向量化。在使用 IA-32 体系结构的系统上：执行一些基本的循环优化，例如分发、谓词选择、交换、多版本控制和标量替换。

优化技术：

- 死代码消除

- 全局寄存器分配

- 全局指令调度和控制推测

- 循环展开

- 变量重命名

- 尾递归

O3：执行 O2 优化并启用更积极的循环转换，例如融合、块展开和堵塞以及折叠 IF 语句。

fast：设置以下选项：

- 在 macOS 系统上：-ipo、-mdynamic-no-pic、-O3、-no-prec-div、-fp-model fast=2 和 -xHost

- 在 Windows 系统上：/O3、/Qipo、/Qprec-div-、/fp：fast=2 和 /QxHost

- 在 Linux 系统上：-ipo、-O3、-no-prec-div、-static、-fp-model fast=2 和 -xHost

##### 2. 任务一中循环展开带来的好处

- 可以减少循环变量的比较次数和分支跳转次数

- 提高单个循环内的计算
  
  - 利用 SIMD 加速
  
  - 提高流水线利用率
